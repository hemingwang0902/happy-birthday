<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <title>Hello ShaSha!</title>
    <style type="text/css">
body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,form,fieldset,input,textarea,p,blockquote,th,td { 
    margin:0;
    padding:0;
}
table {
    border-collapse:collapse;
    border-spacing:0;
}
fieldset,img { 
    border:0;
}
address,caption,cite,code,dfn,em,strong,th,var {
    font-style:normal;
    font-weight:normal;
}
ol,ul {
    list-style:none;
}
caption,th {
    text-align:left;
}
h1,h2,h3,h4,h5,h6 {
    font-size:100%;
    font-weight:bold;
}
q:before,q:after {
    content:'';
}
abbr,acronym { border:0;
}

body, html {
    height: 100%;
    width: 100%;
}

/* Common 定义基本样式 */
body {
    font: 12px/1.8 'Microsoft Yahei','Helvetica Neue',Helvetica,Arial,Sans-serif;
    padding: 0;
    margin: 0;
    color: #333333;
}

#map {
    height: 100%;
    width: 100%;
}

#loading {
    height: 100%;
    width: 100%;
    position: absolute;
    z-index: 999;
    background: url("images/site/loading.gif") no-repeat center center #FFFAD1;
    top: 0;
    left: 0;
    text-align: center;
    line-height: 300px;
    font-size: 32px;
    color: #666;
}
#theEnd {
    height: 0%;
    width: 100%;
    line-height: 0;
    font-size: 0;
    overflow: hidden;
    position: absolute;
    z-index: 999;
    background-color: #FFFAD1;
    top: 0;
    left: 0;
}

#theEndText {
    position: absolute;
    left: 0;
    z-index: 9999;
    width: 100%;
    text-align: center;
    font-size: 26px;
    line-height: 2;
    top: 50%;
    margin-top: -100px;
    height: 200px;
}
    </style>
</head>
<body>
    <div id="loading">正在加载...</div>
    <div id="theEnd"></div>
    <div id="map"></div>

<!-- 指定全局的分享内容 -->
<input id="wsContent" type="hidden" value="一个送给老婆的生日礼物，也是送给所有异地恋人的礼物「变得是距离，不变的是坚持」！">
<!-- 指定全局的分享链接 -->
<input id="wsUrl" type="hidden" value="https://hemw.us.kg/">
<!-- 指定全局的分享图片 -->
<input id="wsPic" type="hidden" value="social.png">

<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="sm/soundmanager2-nodebug-jsmin.js"></script>
<script type="text/javascript">
(function(a,b){"use strict";var c=function(){var a=[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreen","fullscreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"]];for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e[1]in b)return e}}();if(!c)return a.screenfull=!1;var d="ALLOW_KEYBOARD_INPUT"in Element,e={init:function(){return b.addEventListener(c[2],function(a){e.isFullscreen=b[c[3]],e.element=b[c[4]],e.onchange(a)}),this},isFullscreen:b[c[3]],element:b[c[4]],request:function(a){a=a||b.documentElement,a[c[0]](d&&Element.ALLOW_KEYBOARD_INPUT),b.isFullscreen||a[c[0]]()},exit:function(){b[c[1]]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(){}};a.screenfull=e.init()})(window,document)
</script>
<script type="text/javascript">

/*
 * 常用变量
 * 梅州嘉应学院： 116.135018,24.33438
 * 广州广外艺：   113.345774,23.153356
 * 426 KM
 * 5H
 */
// 初始化地图中心
var MP_CEN = {lng: 3.894763, lat: 44.529534};
// 中国中心
var CN_CEN = {lng: 103.758427, lat: 36.172333};
// 嘉应学院
var MZ_JYU = {lng: 116.135018, lat: 24.33438};
// 广外艺
var GZ_GTC = {lng: 113.345774, lat: 23.153356};
// 广州市
var GD_GZS = {lng: 113.256838, lat: 23.157309};
// 河源市
var GD_HYS = {lng: 114.701682, lat: 23.754195};


//北京中关村软件园
var BJ_ZGCSLGY = {lng:116.296675,lat: 40.070659};
//儋州中心公园
var DZ_ZXGY = {lng:109.600665, lat: 19.527104};
//北京市
var CITY_BJS = {lng: 116.415192, lat: 39.910618};
//儋州市
var CITY_DZS = {lng: 109.576716, lat: 19.541881};
//天津市
var CITY_TJS = {lng: 117.217514, lat: 39.145105};

var TJ = {
    HUO_CHE_ZHAN : {lng: 117.215818,lat:39.141564}
}
var BJ = {
    SHOU_DU_AIRPORT : {lng: 116.599373, lat: 40.085678},//首都机场
    TIAN_AN_MEN : {lng: 116.404015, lat: 39.912733},//首都天安门
    ZGC_SOFT_PARK : {lng: 116.298982, lat:40.054663},//首都中关村软件园
    JIA_HUA_MOVIE_THEATER :  {lng: 116.360465, lat:40.014328},//首都-学清路-嘉华国际影城
    CHAO_YANG_JOY_CITY : {lng: 116.360465, lat:40.014328},//首都-朝阳大悦城-金银岛英雄联盟
    CITY_BJS_NAN_LUO_GU_XIANG : {lng: 116.409543, lat:39.940445},//首都-南锣鼓巷
    MA_JIA_PU_QUAN_JU_DE : {lng: 116.385184,lat:39.850229},//首都-马家堡-全聚德
    ZOO : {lng: 116.34203,lat:39.947047},//动物园
    SUBMARINE_WORLD : {lng: 116.312656,lat:39.92479},//太平洋海底世界
    CCTV_TOWER : {lng: 116.312781,lat:39.925488},//中央电视塔
    HU_GUO_SI : {lng: 116.379375,lat:39.941849},//护国寺
    SHANG_DI_HUA_LIAN : {lng: 116.31805,lat:40.035192},//上地华联
    WU_DAO_KOU_WANG_YI : {lng: 116.33774,lat:39.998874},//五道口-网易
    SAN_LI_TUN : {lng: 116.461914,lat:39.939606},//三里屯
    XI_DAN : {lng: 116.378948,lat:39.917527},//西单大悦城
    YUAN_MING_YUAN : {lng: 116.310544,lat:40.011613},//圆明园
    XIANG_SHAN : {lng: 116.196341,lat:39.996594},//香山公园
    HUI_LONG_GUAN : {lng: 116.340705,lat:40.080745},//回龙观-啃壹锅
    BTI_TI_BIAN_YI_FANG : {lng: 116.320378,lat:40.026753},//北体-便宜坊
    WANG_FU_JING : {lng: 116.417863,lat:39.920198},//王府井
    SHANG_DI_JU_YUAN : {lng: 116.299643,lat:40.040779},//上地菊园
    HAI_DIAN_GONG_YUAN : {lng: 116.301918,lat:39.993153},//海淀公园
    DA_ZHA_LAN : {lng: 116.400959,lat:39.902037},//大栅栏
    CHAO_YANG_QU : {lng: 116.444513,lat:39.96194},//朝阳区
    HUAN_LE_GU : {lng: 116.501593,lat:39.874099},//欢乐谷
    DA_KU_CHA : {lng: 116.470909,lat:39.920992},//大裤衩
    MU_XI_YUAN : {lng: 116.405239,lat:39.867267},//木樨园
    SHANG_DI : {lng: 116.310352,lat:40.051673},//上地
    HUO_CHE_NAN_ZHAN :{lng: 116.385521,lat:39.87113}//火车南站
}
// 背景音乐
var MUSIC;

function zoomTo(zoom, time, callback, point) {
    var time     = time || 1000;
    var callback = callback || function() {};
    var loop     = '';
    function loopZoom() {
        var curZoom  = map.getZoom();
        if( curZoom == zoom ) {
            clearTimeout(loop);
            callback();
            return false;
        }
        var plus    = curZoom > zoom ? -1 : 1;
        var toZoom  = curZoom + plus;
        map.setZoom(toZoom);
        if( point ) {
            map.setCenter(point);
        }
        var center = map.getCenter();
        loop = setTimeout(loopZoom, time);
    }
    loopZoom();
}

function loopWin(loopList, time, callback) {
    var i    = 0;
    var len  = loopList.length;
    var callback = callback || function () {};
    var timeout = '';

    function loopWinInner() {
        if( i == len ) {
            clearTimeout(timeout);
            setTimeout(callback, 1000);
            return false;
        }

        var opts = {
            title: loopList[i].title,
            maxWidth: 600,
            height: 0
        }
        var infoWindow = new BMap.InfoWindow(loopList[i].content, opts);
        map.openInfoWindow(infoWindow, new BMap.Point(loopList[i].point.lng, loopList[i].point.lat));
        infoWindow.redraw();
        i++;
        if( loopList[i] ) {
            var time = loopList[i].timeout || 2000;
        } else {
            var time = 2000;
        }
        timeout = setTimeout(loopWinInner, time);
    }

    loopWinInner();
}

function panZoom_DZZXGY() {
    map.panTo(new BMap.Point(DZ_ZXGY.lng, DZ_ZXGY.lat));
    setTimeout(function() {
        zoomTo(18, 800, function() {
            var marker = new BMap.Marker(DZ_ZXGY);
            map.addOverlay(marker);
            marker.setAnimation(BMAP_ANIMATION_BOUNCE);
            setTimeout(panZoom_BJZGCSLGY, 1000);
        }, DZ_ZXGY);
    }, 800);
}

function panZoom_BJZGCSLGY() {
    zoomTo(8, 1000, function() {
        map.panTo(new BMap.Point(BJ_ZGCSLGY.lng, BJ_ZGCSLGY.lat));
        setTimeout(function() {
            zoomTo(16, 800, function() {
                var marker = new BMap.Marker(BJ_ZGCSLGY);
                map.addOverlay(marker);
                marker.setAnimation(BMAP_ANIMATION_BOUNCE);
                setTimeout(panZoom_DZ2BJ, 1000);
            });
        }, 1000);
    });
}

function panZoom_DZ2BJ() {
    zoomTo(9, 1000, function() {
        map.panTo(new BMap.Point(CITY_BJS.lng, CITY_BJS.lat));
        setTimeout(function() {
            var start   = new BMap.Point(DZ_ZXGY.lng, DZ_ZXGY.lat);
            var end = new BMap.Point(BJ_ZGCSLGY.lng, BJ_ZGCSLGY.lat);
            var driving2 = new BMap.DrivingRoute(map, {renderOptions:{map: map, autoViewport: true}});
            driving2.search(start, end);
            setTimeout(function() {
                var between = [
                    {
                        title: '北京 → 儋州',
                        content: '3000+ km.',
                        point: BJ_ZGCSLGY
                    },
                    {
                        title: '儋州 → 北京',
                        content: '38 hours by train. or 4 hours by airplane.',
                        point: DZ_ZXGY
                    },
                    {
                        title: '「变得是距离，不变的是坚持」',
                        content: '<img src="images/0feiji.jpg" width="200" height="149" alt="「变得是距离，不变的是坚持」" />',
                        point: DZ_ZXGY
                    }
                ];
                loopWin(between, 2000, showBJPhotos);
            }, 2000);
        }, 1000);
    });
}

function showBJPhotos() {
    map.clearOverlays();
    map.panTo(new BMap.Point(CITY_BJS.lng, CITY_BJS.lat));
    setTimeout(function () {
        zoomTo(13, 1000, function () {
            var bj_photos = [
                {
                    title: '首都机场',
                    content: '<img src="images/0feiji1.jpg" width="200" height="150" alt="首都机场" />',
                    point: {lng: BJ.SHOU_DU_AIRPORT.lng, lat:BJ.SHOU_DU_AIRPORT.lat}
                },
                {
                    title: '天安门',
                    content: '<img src="images/_9tam.jpg" width="200" height="150" alt="天安门" /><img src="images/_9tam1.jpg" width="200" height="150" alt="天安门" />',
                    point: {lng: BJ.TIAN_AN_MEN.lng, lat: BJ.TIAN_AN_MEN.lat}
                },
                {
                    title: '中关村软件园',
                    content: '<img src="images/1zgcrjy.jpg" width="200" height="150" alt="中关村软件园" />' +
                            '<img src="images/1zgcrjy2.jpg" width="125" height="167" alt="中关村软件园" />' +
                            '<img src="images/1zgcrjy3.jpg" width="200" height="150" alt="中关村软件园" />',
                    point: {lng: BJ.ZGC_SOFT_PARK.lng, lat: BJ.ZGC_SOFT_PARK.lat}
                },
                {
                    title: '嘉华国际影城',
                    content: '<img src="images/2tiedani0.jpg" width="150" height="200" alt="嘉华国际影城" /><img src="images/2tiedani2.jpg" width="160" height="125" alt="嘉华国际影城" /><img src="images/2tiedani.jpg" width="160" height="125" alt="嘉华国际影城-铁达尼号-雷人翻译【你跳，我跳！】" />',
                    point: {lng: BJ.JIA_HUA_MOVIE_THEATER.lng, lat: BJ.JIA_HUA_MOVIE_THEATER.lat}
                },
                {
                    title: '朝阳大悦城-金银岛英雄联盟-抓娃娃-旋转木马',
                    content: '<img src="images/3zhuaniu_1.jpg" width="150" height="200" alt="抓牛" />' +
                            '<img src="images/3zhuaniu.jpg" width="160" height="125" alt="收获" />' +
                            '<img src="images/3zhuaniu1.jpg" width="160" height="125" alt="切水果" />' +
                            '<img src="images/3zhuaniu2.jpg" width="150" height="125" alt="跳舞机" />' +
                            '<img src="images/3zhuaniu3.jpg" width="160" height="125" alt="旋转木马" />',
                    point: {lng: BJ.CHAO_YANG_JOY_CITY.lng, lat: BJ.CHAO_YANG_JOY_CITY.lat}
                },
                {
                    title: '南锣鼓巷',
                    content: '<img src="images/4nlgx.jpg" width="500" height="373" alt="南锣鼓巷" />',
                    point: {lng: BJ.CITY_BJS_NAN_LUO_GU_XIANG.lng, lat: BJ.CITY_BJS_NAN_LUO_GU_XIANG.lat}
                },
                {
                    title: '马家堡-全聚德',
                    content: '<img src="images/5qjd0.jpg" width="150" height="200" alt="马家堡-全聚德" />' +
                            '<img src="images/5qjd1.jpg" width="160" height="125" alt="马家堡-全聚德" />',
                    point: {lng: BJ.MA_JIA_PU_QUAN_JU_DE.lng, lat: BJ.MA_JIA_PU_QUAN_JU_DE.lat}
                },
                {
                    title: '北京动物园',
                    content: '<img src="images/6bjdwy.jpg" width="200" height="150" alt="北京动物园" />' +
                            '<img src="images/6bjdwy4.jpg" width="200" height="150" alt="北京动物园" />' +
                            '<img src="images/6bjdwy5.jpg" width="200" height="150" alt="北京动物园" />' +
                            '<img src="images/6bjdwy6.jpg" width="200" height="150" alt="北京动物园" />' +
                            '<img src="images/6bjdwy2.jpg" width="200" height="150" alt="北京动物园" />' +
                            '<img src="images/6bjdwy1.jpg" width="200" height="150" alt="北京动物园" />',
                    point: {lng: BJ.ZOO.lng, lat: BJ.ZOO.lat}
                },
                {
                    title: '太平洋海底世界',
                    content: '<img src="images/7hysj0.jpg" width="200" height="150" alt="太平洋海底世界" />' +
                            '<img src="images/7hysj1.jpg" width="200" height="150" alt="太平洋海底世界" />' +
                            '<img src="images/7hysj2.jpg" width="200" height="150" alt="太平洋海底世界" />' +
                            '<img src="images/7hysj3.jpg" width="200" height="150" alt="太平洋海底世界" />' +
                            '<img src="images/7hysj5.jpg" width="200" height="150" alt="太平洋海底世界" />',
                    point: {lng: BJ.SUBMARINE_WORLD.lng, lat: BJ.SUBMARINE_WORLD.lat}
                },
                {
                    title: '中央电视塔',
                    content: '<img src="images/8dst0.jpg" width="150" height="200" alt="中央电视塔" />' +
                            '<img src="images/8dst-1.jpg" width="200" height="150" alt="中央电视塔" />' +
                            '<img src="images/8dst.jpg" width="200" height="150" alt="中央电视塔" />' +
                            '<img src="images/8dst1.jpg" width="200" height="150" alt="中央电视塔" />' +
                            '<img src="images/8dst2.jpg" width="200" height="150" alt="中央电视塔" />' +
                            '<img src="images/8dst3.jpg" width="200" height="150" alt="中央电视塔" />',
                    point: {lng: BJ.CCTV_TOWER.lng, lat: BJ.CCTV_TOWER.lat}
                },
                {
                    title: '护国寺',
                    content: '<img src="images/9hgs.jpg" width="300" height="400" alt="护国寺" />',
                    point: {lng: BJ.HU_GUO_SI.lng, lat: BJ.HU_GUO_SI.lat}
                },
                {
                    title: '上地华联',
                    content: '<img src="images/10bjhl.jpg" width="160" height="125" alt="上地华联" />' +
                            '<img src="images/10bjhl1.jpg" width="160" height="125" alt="上地华联" />',
                    point: {lng: BJ.SHANG_DI_HUA_LIAN.lng, lat: BJ.SHANG_DI_HUA_LIAN.lat}
                },
                {
                    title: '五道口-网易大楼',
                    content: '<img src="images/11wy.jpg" width="250" height="335" alt="五道口-网易大楼" />',
                    point: {lng: BJ.WU_DAO_KOU_WANG_YI.lng, lat: BJ.WU_DAO_KOU_WANG_YI.lat}
                },
                {
                    title: '三里屯',
                    content: '<img src="images/12slt.jpg" width="150" height="200" alt="三里屯" />' +
                            '<img src="images/12slt1.jpg" width="160" height="120" alt="三里屯" />',
                    point: {lng: BJ.SAN_LI_TUN.lng, lat: BJ.SAN_LI_TUN.lat}
                },
                {
                    title: '西单',
                    content: '<img src="images/12w_xd.jpg" width="167" height="125" alt="西单" />' +
                            '<img src="images/12w_xd1.jpg" width="167" height="125" alt="西单" />' +
                            '<img src="images/12w_xd2.jpg" width="167" height="125" alt="西单" />' +
                            '<img src="images/12w_xd3.jpg" width="160" height="125" alt="西单" />' +
                            '<img src="images/12w_xd5.jpg" width="160" height="210" alt="西单" />' +
                            '<img src="images/12w_xd4.jpg" width="150" height="200" alt="西单" />',
                    point: {lng: BJ.XI_DAN.lng, lat: BJ.XI_DAN.lat}
                },
                {
                    title: '圆明园',
                    content: '<img src="images/13ymy1.jpg" width="167" height="125" alt="圆明园" />' +
                            '<img src="images/13ymy.jpg" width="167" height="125" alt="圆明园" />' +
                            '<img src="images/13ymy2.jpg" width="167" height="125" alt="圆明园" />' +
                            '<img src="images/13ymy3.jpg" width="167" height="125" alt="圆明园" />' +
                            '<img src="images/13ymy4.jpg" width="167" height="125" alt="圆明园" />',
                    point: {lng: BJ.YUAN_MING_YUAN.lng, lat: BJ.YUAN_MING_YUAN.lat}
                },
                {
                    title: '香山',
                    content: '<img src="images/14xs1.jpg" width="167" height="125" alt="香山" />' +
                            '<img src="images/14xs.jpg" width="167" height="125" alt="香山" />',
                    point: {lng: BJ.XIANG_SHAN.lng, lat: BJ.XIANG_SHAN.lat}
                },
                {
                    title: '回龙观-啃壹锅',
                    content: '<img src="images/15hlg.jpg" width="335" height="250" alt="回龙观-啃壹锅" />',
                    point: {lng: BJ.HUI_LONG_GUAN.lng, lat: BJ.HUI_LONG_GUAN.lat}
                },
                {
                    title: '北体-便宜坊',
                    content: '<img src="images/17bjtydx1.jpg" width="200" height="150" alt="北体-便宜坊" />' +
                             '<img src="images/17bjtydx.jpg" width="200" height="150" alt="北体-便宜坊" />',
                    point: {lng: BJ.BTI_TI_BIAN_YI_FANG.lng, lat: BJ.BTI_TI_BIAN_YI_FANG.lat}
                },
                {
                    title: '王府井',
                    content: '<img src="images/18wfj3.jpg" width="200" height="150" alt="王府井" />' +
                            '<img src="images/18wfj1.jpg" width="200" height="150" alt="王府井" />' +
                            '<img src="images/18wfj2.jpg" width="200" height="150" alt="王府井" />' +
                            '<img src="images/18wfj4.jpg" width="160" height="210" alt="王府井" />' +
                            '<img src="images/18wfj5.jpg" width="160" height="210" alt="王府井" />',
                    point: {lng: BJ.WANG_FU_JING.lng, lat: BJ.WANG_FU_JING.lat}
                },
                {
                    title: '上地菊园',
                    content: '<img src="images/19jy.jpg" width="400" height="300" alt="上地菊园" />',
                    point: {lng: BJ.SHANG_DI_JU_YUAN.lng, lat: BJ.SHANG_DI_JU_YUAN.lat}
                },
                {
                    title: '海淀公园',
                    content: '<img src="images/20hdgy0.jpg" width="200" height="150" alt="海淀公园" />' +
                            '<img src="images/20hdgy.jpg" width="200" height="150" alt="海淀公园" />' +
                            '<img src="images/20hdgy1.jpg" width="200" height="150" alt="海淀公园" />' +
                            '<img src="images/20hdgy2.jpg" width="200" height="150" alt="海淀公园" />' +
                            '<img src="images/20hdgy4.jpg" width="200" height="150" alt="海淀公园" />',
                    point: {lng: BJ.HAI_DIAN_GONG_YUAN.lng, lat: BJ.HAI_DIAN_GONG_YUAN.lat}
                },
                {
                    title: '大栅栏',
                    content: '<img src="images/21dzl8.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl7.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl11.jpg" width="160" height="210" alt="大栅栏" />' +
                            '<img src="images/21dzl10.jpg" width="160" height="210" alt="大栅栏" />' +
                            '<img src="images/21dzl6.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl1.jpg" width="200" height="150" alt="大栅栏" />',
                    point: {lng: BJ.DA_ZHA_LAN.lng, lat: BJ.DA_ZHA_LAN.lat}
                },
                {
                    title: '大栅栏',
                    content:'<img src="images/21dzl.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl5.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl2.jpg" width="175" height="130" alt="大栅栏" />' +
                            '<img src="images/21dzl3.jpg" width="200" height="150" alt="大栅栏" />' +
                            '<img src="images/21dzl4.jpg" width="200" height="150" alt="大栅栏" />',
                    point: {lng: BJ.DA_ZHA_LAN.lng, lat: BJ.DA_ZHA_LAN.lat}
                },
                {
                    title: '朝阳-制作泥塑像',
                    content: '<img src="images/100bj_cyq.jpg" width="160" height="210" alt="朝阳-制作泥塑像" />' +
                            '<img src="images/100bj_cyq1.jpg" width="160" height="210" alt="朝阳-制作泥塑像" />' +
                            '<img src="images/100bj_cyq2.jpg" width="160" height="210" alt="朝阳-制作泥塑像" />',
                    point: {lng: BJ.CHAO_YANG_QU.lng, lat: BJ.CHAO_YANG_QU.lat}
                },
                {
                    title: '欢乐谷',
                    content: '<img src="images/110bj_hlg0.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg01.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg4.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg5.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg6.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg7.jpg" width="200" height="150" alt="欢乐谷" />',
                    point: {lng: BJ.HUAN_LE_GU.lng, lat: BJ.HUAN_LE_GU.lat}
                },
                {
                    title: '欢乐谷',
                    content: '<img src="images/110bj_hlg8.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg9.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg10.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg10_1.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg11.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg2.jpg" width="200" height="150" alt="欢乐谷" />' +
                            '<img src="images/110bj_hlg3.jpg" width="200" height="150" alt="欢乐谷" />',
                    point: {lng: BJ.HUAN_LE_GU.lng, lat: BJ.HUAN_LE_GU.lat}
                },
                {
                    title: '大裤衩',
                    content: '<img src="images/111bj_dkc.jpg" width="160" height="210" alt="大裤衩" />' +
                            '<img src="images/111bj_dkc1.jpg" width="160" height="210" alt="大裤衩" />',
                    point: {lng: BJ.DA_KU_CHA.lng, lat: BJ.DA_KU_CHA.lat}
                },
                {
                    title: '木樨园',
                    content: '<img src="images/201bj_mxy.jpg" width="160" height="210" alt="木樨园" />' +
                            '<img src="images/201bj_mxy1.jpg" width="160" height="210" alt="木樨园" />',
                    point:  {lng: BJ.MU_XI_YUAN.lng, lat: BJ.MU_XI_YUAN.lat}
                },
                {
                    title: '上地',
                    content: '<img src="images/202bj_sd7j.jpg" width="425" height="320" alt="上地" />',
                    point: {lng: BJ.SHANG_DI.lng, lat: BJ.SHANG_DI.lat}
                }
            ];
            loopWin(bj_photos, 2500, panZoom_BJ2TJ);
        });
    }, 1000);
}
function panZoom_BJ2TJ() {
    zoomTo(9, 1000, function() {
        map.panTo(new BMap.Point(CITY_BJS.lng, CITY_BJS.lat));
        setTimeout(function() {
            var start   = new BMap.Point(BJ.HUO_CHE_NAN_ZHAN.lng, BJ.HUO_CHE_NAN_ZHAN.lat);
            var end = new BMap.Point(TJ.HUO_CHE_ZHAN.lng, TJ.HUO_CHE_ZHAN.lat);
            var driving2 = new BMap.DrivingRoute(map, {renderOptions:{map: map, autoViewport: true}});
            driving2.search(start, end);
            setTimeout(function() {
                var between = [
                    {
                        title: '北京 → 天津',
                        content: '<img src="images/50tj0.jpg" width="300" height="400" alt="「第一次旅行」" />',
                        point: BJ.HUO_CHE_NAN_ZHAN
                    }
                ];
                loopWin(between, 2000, showTJPhotos);
            }, 2000);
        }, 1000);
    });
}
function showTJPhotos() {
    map.clearOverlays();
    map.panTo(new BMap.Point(CITY_TJS.lng, CITY_TJS.lat));
    setTimeout(function () {
        zoomTo(13, 1000, function () {
            var tj_photos = [
                {
                    title: '天津-火车站',
                    content: '<img src="images/50tj.jpg" width="200" height="150" alt="天津火车站" />' +
                            '<img src="images/56tj_tjhcz1.jpg" width="200" height="150" alt="天津火车站" />' +
                            '<img src="images/56tj_tjhcz.jpg" width="200" height="150" alt="天津火车站" />',
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-狗不理总店',
                    content: '<img src="images/50tj_gbl.jpg" width="200" height="150" alt="天津-狗不理总店" />' +
                            '<img src="images/50tj_gb4.jpg" width="200" height="150" alt="天津-狗不理总店" />' +
                            '<img src="images/50tj_gbl.jpg" width="200" height="150" alt="天津-狗不理总店" />' +
                            '<img src="images/50tj_gb2.jpg" width="200" height="150" alt="天津-狗不理总店" />' +
                            '<img src="images/50tj_gb3.jpg" width="200" height="150" alt="天津-狗不理总店" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-南市食品街',
                    content: '<img src="images/51tj_nsc0.jpg" width="150" height="200" alt="天津-南市食品街" />' +
                            '<img src="images/51tj_nsc1.jpg" width="200" height="150" alt="天津-南市食品街" />' +
                            '<img src="images/51tj_nsc2.jpg" width="150" height="200" alt="天津-南市食品街" />'  ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-瓷房子',
                    content: '<img src="images/52tj_cfz.jpg" width="150" height="200" alt="天津-瓷房子" />' +
                            '<img src="images/52tj_cfz1.jpg" width="150" height="200" alt="天津-瓷房子" />' +
                            '<img src="images/52tj_cfz2.jpg" width="200" height="150" alt="天津-瓷房子" />' +
                            '<img src="images/52tj_cfz3.jpg" width="200" height="150" alt="天津-瓷房子" />' +
                            '<img src="images/52tj_cfz4.jpg" width="200" height="150" alt="天津-瓷房子" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-步行街',
                    content: '<img src="images/53tj_nml.jpg" width="200" height="150" alt="天津-步行街" />' +
                            '<img src="images/53tj_nml1.jpg" width="200" height="150" alt="天津-步行街" />',
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-意式风景区',
                    content: '<img src="images/54tj_ysfjq0.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq1.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq2.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq3.jpg" width="200" height="150" alt="天津-意式风景区" />',
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-意式风景区',
                    content: '<img src="images/54tj_ysfjq4.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq5.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq6.jpg" width="200" height="150" alt="天津-意式风景区" />' +
                            '<img src="images/54tj_ysfjq7.jpg" width="200" height="150" alt="天津-意式风景区" />'+
                            '<img src="images/54tj_ysfjq8.jpg" width="200" height="150" alt="天津-意式风景区" />'+
                            '<img src="images/54tj_ysfjq9.jpg" width="200" height="150" alt="天津-意式风景区" />',
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-天津之眼',
                    content: '<img src="images/55tj_tjzy.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy1.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy2.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy3.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy4.jpg" width="150" height="200" alt="天津-天津之眼" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-天津之眼',
                    content: '<img src="images/55tj_tjzy5.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy6.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy7.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy8.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy9.jpg" width="150" height="200" alt="天津-天津之眼" />' +
                            '<img src="images/55tj_tjzy10.jpg" width="150" height="200" alt="天津-天津之眼" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-古玩城',
                    content: '<img src="images/58tj_gwj2.jpg" width="150" height="200" alt="天津-古玩城" />' +
                            '<img src="images/58tj_gwj3.jpg" width="150" height="200" alt="天津-古玩城" />' +
                            '<img src="images/58tj_gwj1.jpg" width="150" height="200" alt="天津-古玩城" />' +
                            '<img src="images/58tj_gwj.jpg" width="150" height="200" alt="天津-古玩城" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-名流茶楼',
                    content: '<img src="images/57tj_mlcl0.jpg" width="150" height="200" alt="天津-名流茶楼" />' +
                            '<img src="images/57tj_mlcl.jpg" width="150" height="200" alt="天津-名流茶楼" />' +
                            '<img src="images/57tj_mlcl1.jpg" width="150" height="200" alt="天津-名流茶楼" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                },
                {
                    title: '天津-名流茶楼',
                    content: '<img src="images/57tj_mlcl0.jpg" width="150" height="200" alt="天津-名流茶楼" />' +
                            '<img src="images/57tj_mlcl.jpg" width="150" height="200" alt="天津-名流茶楼" />' +
                            '<img src="images/57tj_mlcl1.jpg" width="150" height="200" alt="天津-名流茶楼" />' ,
                    point: {lng: 113.252764, lat: 23.131838}
                }
            ];
            loopWin(tj_photos, 2500, wannaTo);
        });
    }, 1000);
}
function showPhotos() {
    setTimeout(function() {
        var between = [
            {
                title: '北京 → 儋州',
                content: '3000+ km.',
                point: BJ_ZGCSLGY
            },
            {
                title: '儋州 → 北京',
                content: '38 hours by train. or 4 hours by airplane.',
                point: DZ_ZXGY
            },
            {
                title: '「变得是距离，不变的是坚持」！',
                content: '<img src="images/0feiji.jpg" width="200" height="149" alt="「变得是距离，不变的是坚持」" />',
                point: DZ_ZXGY
            }
        ];
        loopWin(between, 2000, showPhotos);
    }, 2000);
    showBJPhotos();
    showTJPhotos();
}

function wannaTo() {
    map.closeInfoWindow();
    zoomTo(5, 1000, function() {
        map.panTo(new BMap.Point(CN_CEN.lng, CN_CEN.lat));
        map.setMapType(BMAP_HYBRID_MAP);
        setTimeout(function() {
            var wanna = [
                {
                    title: '',
                    content: '地图标上想去的地方，有一天，带着你去流浪。',
                    point: CN_CEN
                },
                {
                    title: '厦门',
                    content: '<img src="images/wannato/xiamen.jpg" width="500" height="338" alt="wannaTo" />',
                    point: {lng: 118.148154, lat: 24.497912}
                },
                {
                    title: '凤凰古镇',
                    content: '<img src="images/wannato/fenghuang.jpg" width="500" height="337" alt="wannaTo" />',
                    point: {lng: 100.21191, lat: 26.928061}
                },
                {
                    title: '桂林阳朔',
                    content: '<img src="images/wannato/guilin.jpg" width="499" height="399" alt="wannaTo" />',
                    point: {lng: 110.503626, lat: 24.780932}
                },
                {
                    title: '西藏',
                    content: '<img src="images/wannato/xizang.jpg" width="500" height="400" alt="wannaTo" />',
                    point: {lng: 91.115691, lat: 29.687083}
                },
                {
                    title: '杭州西湖',
                    content: '<img src="images/wannato/xihu.jpg" width="500" height="327" alt="wannaTo" />',
                    point: {lng: 120.151946, lat: 30.250472}
                }
            ];
        loopWin(wanna, 1000, showMarkerText);
        }, 1000);
    });
}

var happyBirthdayMarkerText = [
    {
        lng : 80.050373,
        lat : 39.924749
    },
    {
        lng : 80.064171,
        lat : 39.832612
    },
    {
        lng : 80.064171,
        lat : 39.747453
    },
    {
        lng : 80.054973,
        lat : 39.647966
    },
    {
        lng : 80.031976,
        lat : 39.566136
    },
    {
        lng : 80.022777,
        lat : 39.469951
    },
    {
        lng : 79.990582,
        lat : 39.366491
    },
    {
        lng : 79.93539,
        lat : 39.273603
    },
    {
        lng : 79.875599,
        lat : 39.216379
    },
    {
        lng : 80.165356,
        lat : 39.697727
    },
    {
        lng : 80.289538,
        lat : 39.70128
    },
    {
        lng : 80.427518,
        lat : 39.708386
    },
    {
        lng : 80.537902,
        lat : 39.708386
    },
    {
        lng : 80.666683,
        lat : 39.711938
    },
    {
        lng : 80.795464,
        lat : 39.715491
    },
    {
        lng : 80.123962,
        lat : 39.402184
    },
    {
        lng : 80.271141,
        lat : 39.420024
    },
    {
        lng : 80.418319,
        lat : 39.423591
    },
    {
        lng : 80.570097,
        lat : 39.423591
    },
    {
        lng : 80.726474,
        lat : 39.427159
    },
    {
        lng : 80.873652,
        lat : 39.434292
    },
    {
        lng : 81.039228,
        lat : 39.434292
    },
    {
        lng : 80.501107,
        lat : 40.105115
    },
    {
        lng : 80.501107,
        lat : 40.01676
    },
    {
        lng : 80.501107,
        lat : 39.921207
    },
    {
        lng : 80.501107,
        lat : 39.829066
    },
    {
        lng : 80.496508,
        lat : 39.623071
    },
    {
        lng : 80.496508,
        lat : 39.544773
    },
    {
        lng : 80.491908,
        lat : 39.370061
    },
    {
        lng : 80.491908,
        lat : 39.255725
    },
    {
        lng : 80.491908,
        lat : 39.166269
    },
    {
        lng : 80.491908,
        lat : 39.087453
    },
    {
        lng : 79.820407,
        lat : 39.015724
    },
    {
        lng : 79.949188,
        lat : 39.008548
    },
    {
        lng : 80.100966,
        lat : 39.030076
    },
    {
        lng : 80.252744,
        lat : 39.030076
    },
    {
        lng : 80.41372,
        lat : 39.030076
    },
    {
        lng : 80.611491,
        lat : 39.051598
    },
    {
        lng : 80.744871,
        lat : 39.05877
    },
    {
        lng : 80.924245,
        lat : 39.05877
    },
    {
        lng : 81.089821,
        lat : 39.073113
    },
    {
        lng : 81.517558,
        lat : 39.775851
    },
    {
        lng : 81.517558,
        lat : 39.708386
    },
    {
        lng : 81.512958,
        lat : 39.605284
    },
    {
        lng : 81.512958,
        lat : 39.480645
    },
    {
        lng : 81.494561,
        lat : 39.38434
    },
    {
        lng : 81.494561,
        lat : 39.262877
    },
    {
        lng : 81.632541,
        lat : 39.81488
    },
    {
        lng : 81.738325,
        lat : 39.811332
    },
    {
        lng : 81.867106,
        lat : 39.811332
    },
    {
        lng : 82.018884,
        lat : 39.804238
    },
    {
        lng : 82.018884,
        lat : 39.704833
    },
    {
        lng : 82.023483,
        lat : 39.598168
    },
    {
        lng : 82.023483,
        lat : 39.502027
    },
    {
        lng : 82.028083,
        lat : 39.395047
    },
    {
        lng : 82.023483,
        lat : 39.320062
    },
    {
        lng : 82.018884,
        lat : 39.24142
    },
    {
        lng : 81.853308,
        lat : 39.219957
    },
    {
        lng : 81.696931,
        lat : 39.230689
    },
    {
        lng : 81.56815,
        lat : 39.234266
    },
    {
        lng : 81.63714,
        lat : 39.530527
    },
    {
        lng : 81.765921,
        lat : 39.530527
    },
    {
        lng : 81.903901,
        lat : 39.530527
    },
    {
        lng : 82.621395,
        lat : 40.020297
    },
    {
        lng : 82.621395,
        lat : 39.921207
    },
    {
        lng : 82.621395,
        lat : 39.811332
    },
    {
        lng : 82.621395,
        lat : 39.708386
    },
    {
        lng : 82.616796,
        lat : 39.605284
    },
    {
        lng : 82.621395,
        lat : 39.459255
    },
    {
        lng : 82.621395,
        lat : 39.35935
    },
    {
        lng : 82.607598,
        lat : 39.24142
    },
    {
        lng : 82.607598,
        lat : 39.159108
    },
    {
        lng : 82.483416,
        lat : 39.647966
    },
    {
        lng : 82.446621,
        lat : 39.555455
    },
    {
        lng : 82.391429,
        lat : 39.469951
    },
    {
        lng : 82.736379,
        lat : 39.687067
    },
    {
        lng : 82.79617,
        lat : 39.59461
    },
    {
        lng : 82.846762,
        lat : 39.519841
    },
    {
        lng : 82.984742,
        lat : 39.829066
    },
    {
        lng : 83.122722,
        lat : 39.832612
    },
    {
        lng : 83.260702,
        lat : 39.836158
    },
    {
        lng : 83.398681,
        lat : 39.846795
    },
    {
        lng : 83.486068,
        lat : 39.860975
    },
    {
        lng : 83.509065,
        lat : 39.775851
    },
    {
        lng : 83.495267,
        lat : 39.694174
    },
    {
        lng : 83.47227,
        lat : 39.626628
    },
    {
        lng : 82.966345,
        lat : 39.544773
    },
    {
        lng : 83.150318,
        lat : 39.551895
    },
    {
        lng : 83.283698,
        lat : 39.551895
    },
    {
        lng : 83.426277,
        lat : 39.559016
    },
    {
        lng : 83.578055,
        lat : 39.559016
    },
    {
        lng : 83.711435,
        lat : 39.569696
    },
    {
        lng : 83.2699,
        lat : 40.140424
    },
    {
        lng : 83.251503,
        lat : 40.066253
    },
    {
        lng : 83.237705,
        lat : 39.97077
    },
    {
        lng : 83.187112,
        lat : 39.754553
    },
    {
        lng : 83.145718,
        lat : 39.658632
    },
    {
        lng : 83.095126,
        lat : 39.47708
    },
    {
        lng : 83.072129,
        lat : 39.337923
    },
    {
        lng : 83.021537,
        lat : 39.216379
    },
    {
        lng : 82.99854,
        lat : 39.159108
    },
    {
        lng : 83.219308,
        lat : 39.47708
    },
    {
        lng : 83.315893,
        lat : 39.387909
    },
    {
        lng : 83.380284,
        lat : 39.312917
    },
    {
        lng : 83.47687,
        lat : 39.259301
    },
    {
        lng : 83.596452,
        lat : 39.202065
    },
    {
        lng : 84.714088,
        lat : 40.249767
    },
    {
        lng : 84.626701,
        lat : 40.228618
    },
    {
        lng : 84.49332,
        lat : 40.179244
    },
    {
        lng : 84.364539,
        lat : 40.151014
    },
    {
        lng : 84.240358,
        lat : 40.112178
    },
    {
        lng : 84.148371,
        lat : 40.080387
    },
    {
        lng : 84.111577,
        lat : 39.992
    },
    {
        lng : 84.139172,
        lat : 39.914124
    },
    {
        lng : 84.198964,
        lat : 39.818426
    },
    {
        lng : 84.014991,
        lat : 39.690621
    },
    {
        lng : 84.175967,
        lat : 39.708386
    },
    {
        lng : 84.318546,
        lat : 39.751003
    },
    {
        lng : 84.479522,
        lat : 39.743902
    },
    {
        lng : 84.612903,
        lat : 39.772302
    },
    {
        lng : 84.810674,
        lat : 39.782949
    },
    {
        lng : 84.976249,
        lat : 39.807785
    },
    {
        lng : 85.114229,
        lat : 39.829066
    },
    {
        lng : 84.589906,
        lat : 40.101583
    },
    {
        lng : 84.589906,
        lat : 40.009687
    },
    {
        lng : 84.589906,
        lat : 39.892869
    },
    {
        lng : 84.580708,
        lat : 39.676405
    },
    {
        lng : 84.571509,
        lat : 39.519841
    },
    {
        lng : 84.571509,
        lat : 39.362921
    },
    {
        lng : 84.576108,
        lat : 39.255725
    },
    {
        lng : 84.576108,
        lat : 39.166269
    },
    {
        lng : 84.465724,
        lat : 39.64441
    },
    {
        lng : 84.350741,
        lat : 39.566136
    },
    {
        lng : 84.240358,
        lat : 39.480645
    },
    {
        lng : 84.024189,
        lat : 39.35578
    },
    {
        lng : 84.139172,
        lat : 39.427159
    },
    {
        lng : 84.695691,
        lat : 39.694174
    },
    {
        lng : 84.815273,
        lat : 39.605284
    },
    {
        lng : 84.916458,
        lat : 39.516279
    },
    {
        lng : 85.036041,
        lat : 39.452124
    },
    {
        lng : 85.123428,
        lat : 39.402184
    },
    {
        lng : 85.224613,
        lat : 39.352209
    },
    {
        lng : 85.376391,
        lat : 39.298623
    },
    {
        lng : 85.500572,
        lat : 39.373631
    },
    {
        lng : 85.51437,
        lat : 39.537651
    },
    {
        lng : 85.348795,
        lat : 39.555455
    },
    {
        lng : 85.24761,
        lat : 39.480645
    },
    {
        lng : 81.407174,
        lat : 40.573219
    },
    {
        lng : 81.250797,
        lat : 40.618798
    },
    {
        lng : 81.103618,
        lat : 40.639824
    },
    {
        lng : 80.95644,
        lat : 40.63632
    },
    {
        lng : 80.901248,
        lat : 40.562697
    },
    {
        lng : 80.951841,
        lat : 40.47143
    },
    {
        lng : 81.057625,
        lat : 40.383557
    },
    {
        lng : 81.204804,
        lat : 40.327257
    },
    {
        lng : 81.388777,
        lat : 40.306132
    },
    {
        lng : 81.526756,
        lat : 40.288523
    },
    {
        lng : 81.696931,
        lat : 40.277955
    },
    {
        lng : 81.526756,
        lat : 40.65734
    },
    {
        lng : 81.563551,
        lat : 40.804295
    },
    {
        lng : 81.696931,
        lat : 40.846222
    },
    {
        lng : 81.830312,
        lat : 40.83225
    },
    {
        lng : 81.922298,
        lat : 40.751849
    },
    {
        lng : 81.926898,
        lat : 40.653837
    },
    {
        lng : 81.9131,
        lat : 40.552172
    },
    {
        lng : 81.885504,
        lat : 40.48548
    },
    {
        lng : 81.848709,
        lat : 40.387074
    },
    {
        lng : 81.793517,
        lat : 40.313174
    }
];

function addMarker(lng, lat) {
    var marker = new BMap.Marker( new BMap.Point(lng, lat) );
    marker.setAnimation(BMAP_ANIMATION_DROP);
    map.addOverlay(marker)
}

if (!Array.prototype.shuffle) {
    Array.prototype.shuffle = function() {
        for(var j, x, i = this.length; i; j = parseInt(Math.random() * i), x = this[--i], this[i] = this[j], this[j] = x);
        return this;
    };
}
happyBirthdayMarkerText.shuffle();
function loopAddMarker(markers, callback) {
    var i           = 0;
    var len         = markers.length;
    var callback    = callback || function() {};
    var loop        = '';
    function loopAddMarkerInner() {
        if( i == len ) {
            clearTimeout(loop);
            callback();
            return false;
        }
        addMarker(markers[i].lng, markers[i].lat);
        i++;
        loop = setTimeout(loopAddMarkerInner, 300);
    }
    loopAddMarkerInner();
}

function showMarkerText() {
    map.closeInfoWindow();
    map.panTo(new BMap.Point(82.699584, 39.8202));
    setTimeout(function() {
        zoomTo(9, 1000, function() {
            loopAddMarker(happyBirthdayMarkerText, function() {
                setTimeout(function() {
                    slideDown('theEnd', 1000, function() {
                        var theEndText = '<div id="theEndText">Happy birthday to my dearest Meijun :) --by LOO2K<br />' +
                                         '<button data-toggle="wshare" data-type="weibo">分享到微博</button>' +
                                         '<button onclick="window.location.reload();">再看一次</button></div>';
                        document.getElementById('theEnd').innerHTML = theEndText;
                    });
                }, 5000);
            });
        })
    }, 1000);
}

function slideDown(id, speed, callback) {
    var object  = document.getElementById(id);
    var timeout = speed*0.001;
    var callback= callback || function() {};
    var loop    = '';
    object.style.display = 'block';
    object.style.height = '0%';
    function slideDownInner() {
        var curHeight = parseFloat(object.style.height) || 0;
        if( curHeight >= 100 ) {
            clearTimeout(loop);
            callback();
            return false;
        }
        object.style.height = (curHeight + 0.1) + '%';
        loop = setTimeout(slideDownInner, timeout);
    }
    slideDownInner();
}

function preLoadImages(imagesList, callback) {
    var len     = imagesList.length;
    var i       = 0;
    var images  = {};
    var callback = callback || function() {};
    function loadImage() {
        if( i == len ) {
            callback();
            return false;
        }
        images[i]           = new Image();
        images[i].src       = imagesList[i];
        i++;
        loadImage();
    }
    loadImage();
}

var map;

function initMap() {
    map = new BMap.Map("map");
    var point = new BMap.Point(MP_CEN.lng, MP_CEN.lat);
    map.centerAndZoom(point, 4);
    map.disableDragging();
    map.disableDoubleClickZoom();
    init();
}

function init() {
    document.getElementById('loading').style.display = 'none';
    document.getElementById('theEnd').style.height = '0';
    document.getElementById('theEnd').innerHTML = '';
    map.setMapType(BMAP_NORMAL_MAP);
    var point = new BMap.Point(MP_CEN.lng, MP_CEN.lat);
    map.centerAndZoom(point, 4);
    map.clearOverlays();
    map.reset();
    MUSIC.play();
    map.panTo(new BMap.Point(DZ_ZXGY.lng, DZ_ZXGY.lat));
    panZoom_DZZXGY();
}

function loadScript() {
  var script = document.createElement("script");
  script.src = "https://api.map.baidu.com/api?v=1.2&callback=initMap";
  document.body.appendChild(script);
}

window.onload = function() {
    var imglist = [
        'images/ticket.jpg',
        'images/feiji.jpg',
        'images/zgcrjy1.jpg',
        'images/chenjiaci1.jpg',
        'images/tiedani2.jpg',
        'images/zhuaniu3.jpg',
        'images/dress1.jpg',
        'images/dress2.jpg',
        'images/jiniantang.jpg',
        'images/leave.jpg',
        'images/s.jpg',
        'images/sea.jpg',
        'images/you.jpg',
        'images/wannato/fenghuang.jpg',
        'images/wannato/guilin.jpg',
        'images/wannato/xiamen.jpg',
        'images/wannato/xihu.jpg',
        'images/wannato/xizang.jpg'
    ];

    soundManager.setup({
        url: 'sm/',
        onready: initMP3
    });

    function initMP3() {

        MUSIC = soundManager.createSound({
            id: 'mp3',
            url: './LemonTree.mp3',
            onload: function() {
                preLoadImages(imglist, function() {
                    setTimeout(function() {
                        var loading = document.getElementById('loading');
                        loading.style.cursor = 'pointer';
                        loading.innerHTML = '点击开始';
                        loading.onclick = function() {
                            screenfull && screenfull.request();
                            loadScript();
                        }
                    }, 3000);
                });
            }
        });
        MUSIC.load();
    }
};
</script>
</body>
</html>
